1. Finish end to end migration with thrust and test
2. Extend to python

